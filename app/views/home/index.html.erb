<div class='mainboard-container'>
    <div class="table table-responsive-lg">
        <table class="table">
            <thead>
                <tr>
                    <th scope="col">title</th>
                    <th scope="col">body</th>
                    <th scope="col">deadline</th>
                    <th scope="col">id(pk)</th>
                    <th scope="col">category_id(fk)</th>
                    <th scope="col">category_name</th>
                    <th scope="col">username</th>
                </tr>
            </thead>
            <tbody>
                <% @tasks.each do |task| %>
                    <tr>
                        <td scope="row"><%= task.title%></td>
                        <td><%= task.body%></td>
                        <td><%= task.deadline%></td>
                        <td><%= task.id%></td>
                        <td><%= task.category_id%></td>
                        <% c = @categories.to_a.map(&:serializable_hash) %>
                        <% c.each do |categ| %>
                            <% if (categ['id'] == task.category_id) %>
                                <td><%= categ['name']%></td>
                            <% end %>   
                        <% end %>
                        <td><%= task.category.user.username%></td>
                        <td><%= link_to "View", task %></td>
                        <td><%= link_to "Edit", edit_task_path(task) %></td>
                        <td><%= link_to "Delete", task, method: :delete, data: { confirm: "Are you sure?" } %></td>
                    </tr>
                <% end %>
            </tbody>
        </table>
    </div>



    <div class="table table-responsive-lg">
        <table class="table">
            <thead>
                <tr>
                    <th scope="col">name</th>
                    <th scope="col">UUID</th>
                    <th scope="col">username</th>
                </tr>
            </thead>
            <tbody>
                <% @categories.each do |categ| %>
                    <tr>
                        <td scope="row"><%= categ.name%></td>
                        <td><%= categ.id%></td>
                        <td><%= categ.user.username%></td>
                        <td><%= link_to "View", categ %></td>
                        <td><%= link_to "Edit", edit_category_path(categ) %></td>
                        <td><%= link_to "Delete", categ, method: :delete, data: { confirm: "Are you sure?" } %></td>
                    </tr>
                <% end %>
            </tbody>
        </table>
        <br>
        <%= link_to "New Category", new_category_path %>
    </div>


    <div class='mainboard'>
        <div class='mainboard-header'>
            <h3>Tasks</h3>
            <div class="form-group scope">
                <select class="form-control" id="sel1">
                    <option selected>Today</option>
                    <option>This Week</option>
                    <option>This Month</option>
                    <option>This Year</option>
                </select>
            </div>
        </div>
        <div class='status-container'>
            <div class='status'>
                <div class='status-header'>
                    <span>Completed</span>
                    <div class='task-counter'><%= @tasks.where(status: "completed").count %></div>

                </div>
            </div>

            <div class='status'>
                <div class='status-header'>
                    <span>In Progress</span>
                    <div class='task-counter'><%= @tasks.where(status: "in_progress").count %></div>
                </div>
            </div>

            <div class='status'>
                <div class='status-header'>
                    <span>To Do</span>
                    <div class='task-counter'><%= @tasks.where(status: "unfinished").count %></div>
                </div>
                <%= link_to "+", new_task_path, type: :button, class: 'btn btn-primary add-task' %>

                <% @tasks.where(status: "unfinished").each do |todo| %>
                    <div class='mytask'>
                        <div class='mytask-title'>
                            <h5><%= todo.title %></h5>
                            <span class='mytask-deadline'><%= todo.deadline %></span>
                        </div>
                        <div class='mytask-body'><%= todo.body.first(200) %></div>
                    </div>
                    
                <% end %>
            </div>
        </div>
        
    </div>

</div>

